---
layout: post
title: vid2vid
categories:
- Research
tags:
- gan
---

[vid2vid](https://arxiv.org/pdf/1808.06601.pdf)提出了一种通用的video to video的生成框架，可以用于很多视频生成任务。常用的pix2pix没有对temporal dynamics建模，所以不能直接用于video synthesis。下面就pose2body对着[vid2vide code](https://github.com/NVIDIA/vid2vid)简单记录一二。

### 1. Network Architecture

#### 1.1 Sequential generator

generator在生成当前帧时需要考虑：1）当前帧的输入图片；2）前几帧的输入图片；3）前几帧的生成图片。到底往前回看多少帧由[n_frames_G](https://github.com/NVIDIA/vid2vid/blob/master/options/base_options.py#L58)控制，如下图n_frames_G=3：

![CompositeGenerator](https://raw.githubusercontent.com/7color94/7color94.github.io/master/imgs/vid2vid/CompositeGenerator.png)

经由generator得到当前帧的预测Intermediate image（img_raw）、前一帧到当前帧的光流Flow map（flow）和occlusion Mask（weight）。当前帧的生成结果最终由前一帧经由光流变化后（img_warp）和当前帧的预测（img_raw）[加权](https://github.com/NVIDIA/vid2vid/blob/master/models/networks.py#L188)而成。

同时对于高分辨率的图片生成，和pix2pixHD一样，提出了coarse-to-fine的[generator](https://github.com/NVIDIA/vid2vid/blob/master/models/networks.py#L201)，由[n_scales_spatial](https://github.com/NVIDIA/vid2vid/blob/master/options/base_options.py#L59)控制：

![CompositeLocalGenerator](https://raw.githubusercontent.com/7color94/7color94.github.io/master/imgs/vid2vid/CompositeLocalGenerator.png)



#### 1.2 Image discriminator

#### 1.2 Video discriminator

### 2. DataLoader

#### 2.1 PoseDataset

### 3. Training

### 4. Test